import customProperty from 'fela-plugin-custom-property'
import arrayReduce from 'fast-loops/lib/arrayReduce'
import * as perf from 'src/lib/perf'

var placeholderPrefixes = [
  '::-webkit-input-placeholder',
  '::-moz-placeholder',
  ':-ms-input-placeholder',
  ':-moz-placeholder',
  '::placeholder',
]

const customPropertyPerf = perf.time(
  '[fela-plugin]: placeholderPrefixer',
  customProperty({
    '::placeholder': function placeholder(value) {
      return arrayReduce(
        placeholderPrefixes,
        function(style, prefix) {
          style[prefix] = value
          return style
        },
        {},
      )
    },
  }),
)

export default function placeholderPrefixer() {
  return customPropertyPerf
}
