import arrayReduce from 'fast-loops/lib/arrayReduce'
import * as perf from '@stardust-ui/react/src/lib/perf'

const processStyles = function(renderer, style, type) {
  var props = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {}

  if (renderer.plugins.length > 0) {
    return arrayReduce(
      renderer.plugins,
      function(processedStyle, plugin) {
        return plugin(processedStyle, type, renderer, props)
      },
      style,
    )
  }

  return style
}
const processStyleWithPlugins = perf.flags.SKIP_FELA_PERF_MARKS
  ? processStyles
  : perf.time('[fela] processStyleWithPlugins', processStyles)

export default processStyleWithPlugins
